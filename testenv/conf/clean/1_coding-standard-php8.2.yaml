depends_on: []
steps:
  - image: owncloudci/drone-skip-pipeline
    name: skip-if-unchanged
    settings:
      ALLOW_SKIP_CHANGED:
        - ^.github/.*
        - ^.vscode/.*
        - ^changelog/.*
        - ^docs/.*
        - ^deployments/.*
        - CHANGELOG.md
        - CONTRIBUTING.md
        - LICENSE
        - README.md
        - .*_test.go$
    when:
      event:
        - pull_request
  - commands:
      - make vendor-bin-codestyle
    environment:
      COMPOSER_HOME: /woodpecker/src/github.com/opencloud-eu/opencloud/.cache/composer
    image: owncloudci/php:8.2
    name: vendorbin-codestyle
  - commands:
      - make vendor-bin-codesniffer
    environment:
      COMPOSER_HOME: /woodpecker/src/github.com/opencloud-eu/opencloud/.cache/composer
    image: owncloudci/php:8.2
    name: vendorbin-codesniffer
  - commands:
      - make test-php-style
    image: owncloudci/php:8.2
    name: php-style
  - commands:
      - make check-env-var-annotations
    image: owncloudci/php:8.2
    name: check-env-var-annotations
when:
  - branch: main
    event:
      - push
      - manual
  - event: pull_request
    ref: refs/pull/**
